<div class="detail">
    <img src="/images/{{payload.thumbnail}}" alt="{{payload.title}}">
    <div class="card-body">
        <h2>{{payload.title}}</h2>
        <p class="card-text">{{payload.description}}</p>
        <p class="card-text"><b>Categoría: </b>{{payload.category}}</p>
        <p class="card-text"><b>Precio: </b>{{payload.price}}</p>
        <p class="card-text"><b>Código: </b>{{payload._id}}</p>
        <p class="card-text"><b>Stock: </b>{{payload.stock}}</p>
        <button id="addToCart" class="btn btn-success">Agregar al carrito</button>
        <button id="delete" class="btn btn-danger">Eliminar</button>
    </div>
</div>
<script>
    document.querySelector("#addToCart").onclick = async (e) => {
        try {
            const cid = "655bdcf9db12be4cc7e741d0";
            const pid = "{{payload._id}}";
            await fetch(`/carts/${cid}/products/${pid}`, { 
                method: "POST",
            })
            .then(() => {
                Toastify({
                    text: "Producto agregado al carrito con éxito",
                    duration: 4000,
                    newWindow: true,
                    close: true,
                    gravity: "top",
                    position: "right",
                    stopOnFocus: true,
                    style: {
                        background: "green",
                        borderRadius: "10px",
                        fontWeight: "600",
                    }
                }).showToast();
                document.location.href = "/products";
            })
        } catch (error) {
            console.error(error);
        };
    };
    document.querySelector("#delete").onclick = async (e) => {
        try {
            const pid = "{{payload._id}}";
            await fetch(`/products/${pid}`, { 
                method: "DELETE",
            })
            .then(() => {
                Toastify({
                    text: "Producto eliminado con éxito",
                    duration: 4000,
                    newWindow: true,
                    close: true,
                    gravity: "top",
                    position: "right",
                    stopOnFocus: true,
                    style: {
                        background: "green",
                        borderRadius: "10px",
                        fontWeight: "600",
                    }
                }).showToast();
                document.location.href = "/products";
            })
        } catch (error) {
            console.error(error);
        };
    };
</script>